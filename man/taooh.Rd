% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/taooh_bootstrap.R
\name{taooh}
\alias{taooh}
\title{Compute time in target state(s) for treatment groups}
\usage{
taooh(
  data,
  formula,
  times = NULL,
  ylevels = 1:6,
  absorb = 6,
  target_states = 1,
  varnames = list(tvarname = "time", pvarname = "yprev", id = "id", tx = "tx")
)
}
\arguments{
\item{data}{A data frame containing patient trajectory data, or an rsample
splits object from bootstrap resampling}

\item{formula}{Model formula for orm (ordinal regression model)}

\item{times}{Time points in the data. Default is \code{1:max(data[["time"]])}}

\item{ylevels}{States in the data (e.g., 1:6)}

\item{absorb}{Absorbing state (e.g., 6 for death)}

\item{target_states}{Integer vector of target state(s) to calculate time in.
Default is 1 (typically "home" or baseline state). Can specify multiple
states, e.g., c(1, 2) to sum time across states 1 and 2.}

\item{varnames}{List of variable names in the data with components:
\itemize{
\item tvarname: time variable name (default "time")
\item pvarname: previous state variable name (default "yprev")
\item id: patient identifier (default "id")
\item tx: treatment indicator (default "tx")
}}
}
\value{
A named numeric vector with three elements:
\itemize{
\item delta_taooh: difference in time in target state(s) (treatment - control)
\item SOP_tx: expected time in target state(s) for treatment group
\item SOP_ctrl: expected time in target state(s) for control group
}
}
\description{
Calculates the expected time spent in specified target state(s) for treatment
and control groups using a proportional odds Markov model. The function fits
an ordinal regression model and uses state occupancy probabilities to estimate
the total time in the target state(s).
}
\details{
The function:
\enumerate{
\item Fits a proportional odds model to the trajectory data
\item Computes state occupancy probabilities for each individual at each time point
\item Sums probabilities across target states and time points
\item Averages within treatment groups to get expected time in target state(s)
}

When data is an rsample splits object (from bootstrap), it extracts the
analysis set and creates unique IDs for each resample. When data is a regular
data frame, it uses the IDs as provided.
}
\examples{
\dontrun{
# Calculate time at home (state 1) for a dataset
result <- taooh(
  data = my_data,
  formula = y ~ tx + yprev + time,
  ylevels = 1:6,
  absorb = 6,
  target_states = 1
)

# Calculate time in states 1 or 2 combined
result <- taooh(
  data = my_data,
  formula = y ~ tx + yprev + time,
  target_states = c(1, 2)
)
}
}
\keyword{alive}
\keyword{hospital}
\keyword{occupancy}
\keyword{of}
\keyword{out}
\keyword{state}
\keyword{time}
