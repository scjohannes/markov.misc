% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sops.R
\name{soprob_markov_ord_m}
\alias{soprob_markov_ord_m}
\title{Calculate State Occupation Probabilities for First-Order Markov Models}
\usage{
soprob_markov_ord_m(
  object,
  data,
  times,
  ylevels,
  absorb = NULL,
  tvarname = "time",
  pvarname = "yprev",
  gap = NULL,
  t_covs = NULL
)
}
\arguments{
\item{object}{A fitted model object. Supported classes include:
\code{"lrm"}, \code{"orm"} (from package \code{rms}),
\code{"blrm"} (from package \code{rmsb}), and
\code{"vglm"}, \code{"vgam"} (from package \code{VGAM}).}

\item{data}{A data frame containing the baseline covariates for the prediction.
Should generally contain a single row representing the subject profile.
Must contain the variable specified in \code{tvarname} (usually initialized to 0 or start time).}

\item{times}{A numeric vector of time points to iterate over.
The function calculates probabilities for each time point in this sequence.}

\item{ylevels}{A character vector defining the names of the outcome levels (states).
These must match the levels used in the fitted \code{object}.}

\item{absorb}{(Optional) A character vector of absorbing states (states from which
transitions out are impossible). Defaults to \code{NULL}.}

\item{tvarname}{A character string specifying the name of the time variable in the
model formula. Defaults to \code{"time"}.}

\item{pvarname}{A character string specifying the name of the previous state variable
used in the model formula. Defaults to \code{"yprev"}.}

\item{gap}{(Optional) A character string specifying the name of the variable representing
the time gap (delta time) between observations, if used in the model. Defaults to \code{NULL}.}

\item{t_covs}{(Optional) A data frame used for non-linear time handling (e.g., splines
or basis functions).
\itemize{
\item \strong{Structure:} The number of rows in \code{t_covs} must exactly match the length of \code{times}.
\item \strong{Columns:} Column names must match the specific basis variables used in the model formula (e.g., \code{t1}, \code{t2}).
\item \strong{Usage:} At step \code{i}, the values from the \code{i}-th row of \code{t_covs} are injected into the prediction data.
}
This allows for \code{vglm} models where basis functions are supplied as separate columns rather than calculated on the fly.}
}
\value{
An array of state probabilities.
\itemize{
\item \strong{Frequentist fit:} A matrix of dimension \code{[length(times) x length(ylevels)]}.
\item \strong{Bayesian fit:} An array of dimension \code{[n_draws x length(times) x length(ylevels)]}.
}
}
\description{
Estimates state occupation probabilities over time by iterating a transition
matrix derived from a fitted model object (e.g., \code{vglm}, \code{rms}, or \code{rmsb}).
This function supports linear time iteration as well as complex, non-linear
time specifications (e.g., splines) via a covariate lookup table.
}
\details{
The function iterates through the vector \code{times}. At each time point \eqn{t}, it:
\enumerate{
\item Updates the time variable (and \code{t_covs} if supplied).
\item Predicts the transition probability matrix \eqn{T(t)} based on the covariates and the previous state.
\item Updates the state occupation probability vector \eqn{P(t)} using the matrix multiplication:
\eqn{P(t) = P(t-1) \times T(t)}.
}

If the model is Bayesian (\code{rmsb}), the output preserves the posterior draws.
}
