% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sops_new.R
\name{sops}
\alias{sops}
\title{Calculate Individual State Occupation Probabilities (Tidy)}
\usage{
sops(
  model,
  newdata = NULL,
  times = NULL,
  ylevels = NULL,
  absorb = NULL,
  tvarname = "time",
  pvarname = "yprev",
  gap = NULL,
  t_covs = NULL,
  ...
)
}
\arguments{
\item{model}{A fitted model object (e.g., \code{vglm}, \code{orm}).}

\item{newdata}{Optional. A data frame of new data for prediction. If NULL,
uses the data used to fit the model.}

\item{times}{A numeric vector of time points to estimate.}

\item{ylevels}{A vector of state levels. If NULL, attempts to infer from model.}

\item{absorb}{Character or integer. The absorbing state.}

\item{tvarname}{Name of the time variable in the model.}

\item{pvarname}{Name of the previous state variable in the model.}

\item{gap}{Name of the time gap variable (if used).}

\item{t_covs}{Optional time-varying covariate lookup table.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A data frame of class \code{markov_sops} containing:
\item{rowid}{Row identifier from newdata}
\item{time}{Time point}
\item{state}{State name}
\item{estimate}{Probability of being in the state}
Plus all columns from \code{newdata}.
}
\description{
Computes individual-level state occupation probabilities (SOPs) for each row
in a dataset. This function serves as the foundation for \code{avg_sops()} and
follows a \code{marginaleffects}-style workflow.
}
\details{
This function wraps \code{soprob_markov()} and converts its array output to a tidy
data frame. The output contains one row per patient-time-state combination.

For computing marginal/standardized SOPs (G-computation), use \code{avg_sops()}
instead, which creates counterfactual datasets and averages over individuals.
}
\seealso{
\code{\link[=avg_sops]{avg_sops()}} for marginal SOPs, \code{\link[=soprob_markov]{soprob_markov()}} for the underlying
computation.
}
