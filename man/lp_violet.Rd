% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lp_violet.R
\name{lp_violet}
\alias{lp_violet}
\title{Default Linear Predictor Function for VIOLET-style Simulations}
\usage{
lp_violet(yprev, t, age, sofa, tx, parameter = 0, extra_params)
}
\arguments{
\item{yprev}{Numeric vector. Previous health state (1-6). State 2 is the
reference level for previous state effects.}

\item{t}{Numeric scalar. Current time point.}

\item{age}{Numeric vector. Patient age in years.}

\item{sofa}{Numeric vector. Sequential Organ Failure Assessment (SOFA) score.}

\item{tx}{Numeric vector. Treatment indicator (0 = control, 1 = treatment).}

\item{parameter}{Numeric scalar. Treatment effect on log odds ratio scale
(default: 0, meaning OR = 1).}

\item{extra_params}{Named numeric vector of model coefficients. Should include:
\itemize{
\item "time": Linear time effect
\item "time'": Spline knot effect for time > 2
\item "age": Age effect per year
\item "sofa": SOFA score effect per point
\item "yprev=1", "yprev=3", "yprev=4", "yprev=5": Previous state effects
(yprev=2 is reference, so no coefficient needed)
\item "yprev=1 * time", "yprev=3 * time", etc.: Time interactions
}}
}
\value{
Numeric vector of linear predictor values, one per patient.
}
\description{
A linear predictor function compatible with the VIOLET study parameters and
the \code{violet_baseline} dataset. This function calculates the linear predictor
for a proportional odds Markov transition model with effects for treatment,
covariates (age, SOFA), time (with spline), and previous state.
}
\details{
The linear predictor is calculated as:

LP = β_tx × tx + β_age × age + β_sofa × sofa +
β_time × t + β_time' × max(t-2, 0) +
β_yprev + β_yprev×time × t

where:
\itemize{
\item Treatment effect (β_tx) comes from the \code{parameter} argument
\item Covariate effects (β_age, β_sofa) come from \code{extra_params}
\item Time has a linear effect plus a spline knot at t=2
\item Previous state effects are relative to state 2 (reference)
\item Previous state can have time-varying effects
}

\strong{State 2 as reference}: The model uses state 2 (Hospital - mild) as the
reference category for previous state. This means:
\itemize{
\item yprev=1 (Home): Typically large negative effect (easier transitions)
\item yprev=2 (Hospital mild): No effect (reference = 0)
\item yprev=3-5 (Sicker states): Positive effects (harder transitions)
}

\strong{Time spline}: The function uses a linear spline with a knot at t=2,
implemented as: β_time × t + β_time' × max(t-2, 0). This allows the time
effect to change slope after day 2.
}
\examples{
# Example with default VIOLET parameters
lp_violet(
  yprev = c(2, 3, 5),
  t = 10,
  age = c(65, 70, 55),
  sofa = c(5, 8, 6),
  tx = c(0, 1, 1),
  parameter = log(0.8),  # OR = 0.8 for treatment
  extra_params = c(
    "time" = -0.738194,
    "time'" = 0.7464006,
    "age" = 0.010321,
    "sofa" = 0.046901,
    "yprev=1" = -8.518344,
    "yprev=3" = 0,
    "yprev=4" = 1.315332,
    "yprev=5" = 6.576662,
    "yprev=1 * time" = 0,
    "yprev=3 * time" = 0,
    "yprev=4 * time" = 0,
    "yprev=5 * time" = 0
  )
)

\dontrun{
# Use with sim_trajectories_markov()
trajectories <- sim_trajectories_markov(
  baseline_data = violet_baseline,
  lp_function = lp_violet,
  parameter = log(0.75),  # OR = 0.75
  seed = 12345
)

# Create a custom version with different time interactions
my_lp <- function(yprev, t, age, sofa, tx, parameter = 0, extra_params) {
  # Start with standard VIOLET LP
  base_lp <- lp_violet(yprev, t, age, sofa, tx, parameter, extra_params)

  # Add custom modification
  # ... your custom code ...

  return(base_lp)
}
}

}
\seealso{
\code{\link{sim_trajectories_markov}} for using this function in simulations

\code{\link{violet_baseline}} for the default baseline dataset
}
