% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_trajectories.R
\name{sim_trajectories_brownian}
\alias{sim_trajectories_brownian}
\title{Simulate Patient Trajectories Using Brownian Motion Latent Ordinal Model}
\usage{
sim_trajectories_brownian(
  n_patients = 1000,
  follow_up_time = 60,
  n_states = 6,
  mu_drift = -0.18,
  mu_treatment_effect = 0,
  sigma_rw = 0.12,
  x0_sd = 1,
  thresholds = c(-3.5, 0, 1, 3, 4.5),
  treatment_prob = 0.5,
  absorbing_state = 6,
  drift_change_times = c(25, 50),
  seed = NULL
)
}
\arguments{
\item{n_patients}{Integer. Number of patients to simulate (default: 1000).}

\item{follow_up_time}{Integer. Number of days to simulate per patient (default: 60).}

\item{n_states}{Integer. Number of ordered states/categories (default: 6).}

\item{mu_drift}{Numeric. Baseline drift per day for control group (default: -0.18).
Negative values indicate improvement (movement toward lower severity).}

\item{mu_treatment_effect}{Numeric. Additional drift for treatment group
(default: 0). Negative values indicate faster improvement with treatment.}

\item{sigma_rw}{Numeric. Random walk innovation standard deviation per day
(default: 0.12). Lower values create stronger autocorrelation.}

\item{x0_sd}{Numeric. Standard deviation for baseline latent severity
(default: 1.0).}

\item{thresholds}{Numeric vector of K-1 cutpoints for the ordered logistic
model (default: c(-3.5, 0, 1, 3, 4.5) for 6 states). Higher values
represent more severe states.}

\item{treatment_prob}{Numeric. Probability of assignment to treatment group
(default: 0.5).}

\item{absorbing_state}{Integer. State number that represents death or other
absorbing state (default: 6). Once entered, patients remain there.}

\item{drift_change_times}{Numeric vector of length 2 specifying when drift
begins to decline and when it reaches zero (default: c(25, 50)).
Drift is constant until first time, then linearly declines to 0 by second time.}

\item{seed}{Integer. Random seed for reproducibility (default: NULL).}
}
\value{
A data frame (tibble) with columns:
\itemize{
\item id: patient identifier
\item time: time/day (1 to follow_up_time)
\item tx: treatment assignment (0 = control, 1 = treatment)
\item y: observed ordinal state at time
\item x: latent continuous severity (NA after entering absorbing state)
}
}
\description{
Generates individual patient trajectories based on a latent continuous severity
variable that evolves as a Gaussian random walk (Brownian motion) with drift.
Observed states are determined by thresholding the latent variable using an
ordered logistic model. This provides an alternative data generating mechanism
for testing the robustness of Markov models.
}
\details{
This function implements a latent variable model where:
\enumerate{
\item Each patient has an unobserved continuous "severity" X(t) that evolves
as a Gaussian random walk: X(t) = X(t-1) + μ(t) + ε, where ε ~ N(0, σ²)
\item The drift μ(t) depends on treatment assignment and time
\item Observed states Y(t) are generated by thresholding X(t) using an ordered
logistic model: P(Y ≤ k) = logit⁻¹(c_k - X)
\item Once a patient enters the absorbing state (death), they remain there
}

\strong{Time-varying drift}: The drift parameter changes over time to model
recovery dynamics. It remains constant until \code{drift_change_times[1]}, then
linearly decreases to 0 by \code{drift_change_times[2]}, representing diminishing
treatment effects or natural recovery plateaus.

\strong{Difference from Markov model}: Unlike the standard Markov transition model
(see \code{sim_trajectories_markov()}), this approach uses a continuous latent variable
rather than direct state-to-state transitions. This provides an alternative
data generating mechanism useful for testing model robustness.
}
\examples{
\dontrun{
# Simulate with default parameters (null hypothesis: no treatment effect)
trajectories <- sim_trajectories_brownian(
  n_patients = 1000,
  follow_up_time = 60,
  seed = 12345
)

# Simulate with treatment effect (faster improvement)
trajectories_tx <- sim_trajectories_brownian(
  n_patients = 1000,
  mu_treatment_effect = -0.05,  # Treatment accelerates improvement
  seed = 12345
)

# Custom thresholds for different severity distribution
trajectories_custom <- sim_trajectories_brownian(
  n_patients = 500,
  thresholds = c(-4, -1, 0, 2, 5),
  sigma_rw = 0.2,  # More variability
  seed = 12345
)
}

}
