% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sops_new.R
\name{get_draws}
\alias{get_draws}
\title{Extract Individual Draws from Inference Objects}
\usage{
get_draws(object)
}
\arguments{
\item{object}{An object returned by \code{inferences()} with \code{return_draws = TRUE}.}
}
\value{
A data frame with columns:
\itemize{
\item draw_id: Simulation or bootstrap iteration number
\item time: Time point
\item state: State number
\item estimate: Draw-specific estimate of state occupation probability
\item point_estimate: The original point estimate from the model
\item conf.low, conf.high, std.error: Summary statistics from the point estimate object
\item Additional columns from the original object (covariates, etc.)
}
Each row represents one draw for a specific time-state combination.
}
\description{
Extracts the individual draws (bootstrap samples, simulated values from MVN, etc.)
from an object returned by \code{inferences()} with \code{return_draws = TRUE}.
This function joins the draws back to the original point estimate object,
preserving all covariates, grouping variables, and summary statistics.
}
\details{
This function retrieves the draws from objects created by \code{inferences()}.
It performs a join between the draws and the point estimate object to ensure
that all metadata is preserved. To avoid conflict, the \code{estimate} column from
the point estimate object is renamed to \code{point_estimate}.
}
\examples{
\dontrun{
# Create object with bootstrap draws
result <- avg_sops(
  model = fit,
  newdata = data,
  variables = list(tx = c(0, 1)),
  times = 1:30,
  ylevels = 1:6,
  absorb = 6,
  id_var = "id"
) |>
  inferences(n_boot = 1000, return_draws = TRUE)

# Extract draws
draws <- get_draws(result)

# Plot distribution for state 1 at time 10 under treatment
library(ggplot2)
draws |>
  filter(time == 10, state == 1, tx == 1) |>
  ggplot(aes(x = estimate)) +
  geom_histogram(bins = 30) +
  labs(title = "Distribution: P(State 1 | Time 10, Treatment)")

# Compute mean time in state 1 with bootstrap CI
library(dplyr)
time_in_state_boot <- draws |>
  filter(state == 1, tx == 1) |>
  group_by(draw_id) |>
  summarise(total_time = sum(estimate))

quantile(time_in_state_boot$total_time, c(0.025, 0.5, 0.975))

# Compare treatment effect on time in state
treatment_effect <- draws |>
  filter(state == 1) |>
  group_by(draw_id, tx) |>
  summarise(total_time = sum(estimate), .groups = "drop") |>
  pivot_wider(names_from = tx, values_from = total_time,
              names_prefix = "tx") |>
  mutate(effect = tx1 - tx0)

quantile(treatment_effect$effect, c(0.025, 0.5, 0.975))
}

}
\seealso{
\code{\link[=inferences]{inferences()}}, \code{\link[=avg_sops]{avg_sops()}}
}
