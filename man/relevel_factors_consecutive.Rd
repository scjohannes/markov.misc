% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/misc.R
\name{relevel_factors_consecutive}
\alias{relevel_factors_consecutive}
\title{Relevel Factors to Consecutive Integers}
\usage{
relevel_factors_consecutive(
  data,
  factor_cols = c("y", "yprev"),
  original_data = NULL,
  ylevels = NULL,
  absorb = NULL
)
}
\arguments{
\item{data}{A data frame containing the data to relevel.}

\item{factor_cols}{Character vector of column names to relevel. Only columns
that are factors with numeric-coercible levels will be releveled.}

\item{original_data}{Optional data frame containing the original data before
subsetting. Used to determine which levels are present in the full dataset.}

\item{ylevels}{Optional integer vector of original state levels (e.g., 1:6).
If provided along with absorb, these will be updated to match the new levels.}

\item{absorb}{Optional integer specifying the absorbing state in the original
levels. Will be updated to the new position if provided.}
}
\value{
A list with components:
\itemize{
\item data: The data frame with releveled factors
\item ylevels: Updated ylevels (if provided as input), or NULL
\item absorb: Updated absorb (if provided as input), or NULL
\item missing_levels: Character vector of levels that were missing
}
}
\description{
Handles missing factor levels in data by releveling ordered factors to
consecutive integers. This is useful when bootstrap samples or subsets
are missing certain levels, which can cause model fitting failures.
}
\details{
When certain factor levels are absent from a dataset (e.g., in bootstrap
samples), this function:
\enumerate{
\item Identifies which levels are present
\item Creates a mapping from old to new consecutive integers
\item Relevels the specified factor columns
\item Updates ylevels and absorb parameters if provided
}

This is particularly useful for ordered factors representing health states
in Markov models, where missing states would otherwise cause model fitting
failures.
}
\examples{
\dontrun{
# Relevel y and yprev in bootstrap sample
releveled <- relevel_factors_consecutive(
  data = boot_data,
  factor_cols = c("y", "yprev"),
  original_data = full_data,
  ylevels = 1:6,
  absorb = 6
)

boot_data <- releveled$data
boot_ylevels <- releveled$ylevels
boot_absorb <- releveled$absorb
}

}
